[2024-06-15 19:34:31,775][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:34:31,775][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:34:31,776][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:34:31,776][root][INFO] - 16-bits training: False 
[2024-06-15 19:34:31,776][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:34:32,752][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:34:32,752][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:34:32,763][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_0
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:34:33,717][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:34:34,591][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:34:35,675][root][INFO] - Loading saved model state ...
[2024-06-15 19:34:35,714][root][INFO] - Selecting standard question encoder
[2024-06-15 19:34:35,987][root][INFO] - Encoder vector_size=768
[2024-06-15 19:34:35,987][root][INFO] - qa_dataset: mapqa_0609_socal_0
[2024-06-15 19:34:35,988][root][INFO] - questions len 51
[2024-06-15 19:34:35,989][root][INFO] - questions_text len 0
[2024-06-15 19:34:35,989][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:34:35,989][root][INFO] - Using special token None
[2024-06-15 19:34:38,068][root][INFO] - Total encoded queries tensor torch.Size([51, 768])
[2024-06-15 19:34:38,069][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:34:38,069][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:34:38,069][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:34:38,069][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:34:38,069][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:34:38,069][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:34:39,985][root][INFO] - data indexed 50000
[2024-06-15 19:34:39,985][root][INFO] - Total data indexed 50000
[2024-06-15 19:34:40,323][root][INFO] - data indexed 100000
[2024-06-15 19:34:40,323][root][INFO] - Total data indexed 100000
[2024-06-15 19:34:40,605][root][INFO] - data indexed 150000
[2024-06-15 19:34:40,606][root][INFO] - Total data indexed 150000
[2024-06-15 19:34:40,888][root][INFO] - data indexed 200000
[2024-06-15 19:34:40,888][root][INFO] - Total data indexed 200000
[2024-06-15 19:34:41,283][root][INFO] - data indexed 250000
[2024-06-15 19:34:41,283][root][INFO] - Total data indexed 250000
[2024-06-15 19:34:41,567][root][INFO] - data indexed 300000
[2024-06-15 19:34:41,567][root][INFO] - Total data indexed 300000
[2024-06-15 19:34:41,730][root][INFO] - data indexed 350000
[2024-06-15 19:34:41,730][root][INFO] - Total data indexed 350000
[2024-06-15 19:34:42,014][root][INFO] - data indexed 400000
[2024-06-15 19:34:42,015][root][INFO] - Total data indexed 400000
[2024-06-15 19:34:42,599][root][INFO] - data indexed 450000
[2024-06-15 19:34:42,599][root][INFO] - Total data indexed 450000
[2024-06-15 19:34:42,873][root][INFO] - data indexed 500000
[2024-06-15 19:34:42,873][root][INFO] - Total data indexed 500000
[2024-06-15 19:34:43,158][root][INFO] - data indexed 550000
[2024-06-15 19:34:43,158][root][INFO] - Total data indexed 550000
[2024-06-15 19:34:43,314][root][INFO] - data indexed 600000
[2024-06-15 19:34:43,315][root][INFO] - Total data indexed 600000
[2024-06-15 19:34:43,435][root][INFO] - data indexed 606770
[2024-06-15 19:34:43,435][root][INFO] - Total data indexed 606770
[2024-06-15 19:34:43,435][root][INFO] - Data indexing completed.
[2024-06-15 19:34:44,392][root][INFO] - index search time: 0.955230 sec.
[2024-06-15 19:34:44,392][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:34:46,108][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:34:46,109][root][INFO] - validating passages. size=606770
[2024-06-15 19:34:46,109][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:34:46,109][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:34:47,344][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:34:47,375][dpr.data.qa_validation][INFO] - Per question validation results len=51
[2024-06-15 19:34:47,556][root][INFO] - Validation results: top k documents hits [5, 6, 8, 10, 11, 11, 11, 11, 11, 11, 11, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18]
[2024-06-15 19:34:47,556][root][INFO] - Validation results: top k documents hits accuracy [0.09803921568627451, 0.11764705882352941, 0.1568627450980392, 0.19607843137254902, 0.21568627450980393, 0.21568627450980393, 0.21568627450980393, 0.21568627450980393, 0.21568627450980393, 0.21568627450980393, 0.21568627450980393, 0.23529411764705882, 0.23529411764705882, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.2549019607843137, 0.27450980392156865, 0.27450980392156865, 0.27450980392156865, 0.27450980392156865, 0.27450980392156865, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3137254901960784, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826]
[2024-06-15 19:34:47,597][root][INFO] - Saved results * scores  to output.json
[2024-06-15 19:34:52,385][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:34:52,385][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:34:52,386][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:34:52,386][root][INFO] - 16-bits training: False 
[2024-06-15 19:34:52,386][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:34:53,300][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:34:53,301][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:34:53,312][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_1
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:34:54,264][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:34:55,146][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:34:56,069][root][INFO] - Loading saved model state ...
[2024-06-15 19:34:56,109][root][INFO] - Selecting standard question encoder
[2024-06-15 19:34:56,360][root][INFO] - Encoder vector_size=768
[2024-06-15 19:34:56,360][root][INFO] - qa_dataset: mapqa_0609_socal_1
[2024-06-15 19:34:56,361][root][INFO] - questions len 50
[2024-06-15 19:34:56,361][root][INFO] - questions_text len 0
[2024-06-15 19:34:56,362][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:34:56,362][root][INFO] - Using special token None
[2024-06-15 19:34:58,424][root][INFO] - Total encoded queries tensor torch.Size([50, 768])
[2024-06-15 19:34:58,425][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:34:58,425][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:34:58,425][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:34:58,425][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:34:58,425][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:34:58,425][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:35:00,386][root][INFO] - data indexed 50000
[2024-06-15 19:35:00,387][root][INFO] - Total data indexed 50000
[2024-06-15 19:35:00,720][root][INFO] - data indexed 100000
[2024-06-15 19:35:00,720][root][INFO] - Total data indexed 100000
[2024-06-15 19:35:00,999][root][INFO] - data indexed 150000
[2024-06-15 19:35:00,999][root][INFO] - Total data indexed 150000
[2024-06-15 19:35:01,283][root][INFO] - data indexed 200000
[2024-06-15 19:35:01,283][root][INFO] - Total data indexed 200000
[2024-06-15 19:35:01,678][root][INFO] - data indexed 250000
[2024-06-15 19:35:01,678][root][INFO] - Total data indexed 250000
[2024-06-15 19:35:01,961][root][INFO] - data indexed 300000
[2024-06-15 19:35:01,961][root][INFO] - Total data indexed 300000
[2024-06-15 19:35:02,126][root][INFO] - data indexed 350000
[2024-06-15 19:35:02,126][root][INFO] - Total data indexed 350000
[2024-06-15 19:35:02,411][root][INFO] - data indexed 400000
[2024-06-15 19:35:02,412][root][INFO] - Total data indexed 400000
[2024-06-15 19:35:03,028][root][INFO] - data indexed 450000
[2024-06-15 19:35:03,028][root][INFO] - Total data indexed 450000
[2024-06-15 19:35:03,316][root][INFO] - data indexed 500000
[2024-06-15 19:35:03,316][root][INFO] - Total data indexed 500000
[2024-06-15 19:35:03,612][root][INFO] - data indexed 550000
[2024-06-15 19:35:03,613][root][INFO] - Total data indexed 550000
[2024-06-15 19:35:03,774][root][INFO] - data indexed 600000
[2024-06-15 19:35:03,774][root][INFO] - Total data indexed 600000
[2024-06-15 19:35:03,893][root][INFO] - data indexed 606770
[2024-06-15 19:35:03,894][root][INFO] - Total data indexed 606770
[2024-06-15 19:35:03,894][root][INFO] - Data indexing completed.
[2024-06-15 19:35:04,793][root][INFO] - index search time: 0.897573 sec.
[2024-06-15 19:35:04,793][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:35:06,524][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:35:06,525][root][INFO] - validating passages. size=606770
[2024-06-15 19:35:06,525][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:35:06,525][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:35:07,754][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:35:07,777][dpr.data.qa_validation][INFO] - Per question validation results len=50
[2024-06-15 19:35:07,941][root][INFO] - Validation results: top k documents hits [6, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14]
[2024-06-15 19:35:07,941][root][INFO] - Validation results: top k documents hits accuracy [0.12, 0.14, 0.14, 0.14, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.18, 0.22, 0.22, 0.22, 0.22, 0.22, 0.22, 0.22, 0.22, 0.22, 0.26, 0.26, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28, 0.28]
[2024-06-15 19:35:07,979][root][INFO] - Saved results * scores  to output.json
[2024-06-15 19:35:12,719][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:35:12,719][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:35:12,719][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:35:12,720][root][INFO] - 16-bits training: False 
[2024-06-15 19:35:12,720][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:35:13,631][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:35:13,632][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:35:13,643][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_2
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:35:14,596][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:35:15,476][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:35:16,338][root][INFO] - Loading saved model state ...
[2024-06-15 19:35:16,378][root][INFO] - Selecting standard question encoder
[2024-06-15 19:35:16,646][root][INFO] - Encoder vector_size=768
[2024-06-15 19:35:16,646][root][INFO] - qa_dataset: mapqa_0609_socal_2
[2024-06-15 19:35:16,647][root][INFO] - questions len 51
[2024-06-15 19:35:16,647][root][INFO] - questions_text len 0
[2024-06-15 19:35:16,648][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:35:16,648][root][INFO] - Using special token None
[2024-06-15 19:35:18,735][root][INFO] - Total encoded queries tensor torch.Size([51, 768])
[2024-06-15 19:35:18,736][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:35:18,736][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:35:18,736][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:35:18,736][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:35:18,736][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:35:18,736][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:35:20,633][root][INFO] - data indexed 50000
[2024-06-15 19:35:20,633][root][INFO] - Total data indexed 50000
[2024-06-15 19:35:20,959][root][INFO] - data indexed 100000
[2024-06-15 19:35:20,959][root][INFO] - Total data indexed 100000
[2024-06-15 19:35:21,227][root][INFO] - data indexed 150000
[2024-06-15 19:35:21,227][root][INFO] - Total data indexed 150000
[2024-06-15 19:35:21,500][root][INFO] - data indexed 200000
[2024-06-15 19:35:21,500][root][INFO] - Total data indexed 200000
[2024-06-15 19:35:21,872][root][INFO] - data indexed 250000
[2024-06-15 19:35:21,872][root][INFO] - Total data indexed 250000
[2024-06-15 19:35:22,144][root][INFO] - data indexed 300000
[2024-06-15 19:35:22,144][root][INFO] - Total data indexed 300000
[2024-06-15 19:35:22,303][root][INFO] - data indexed 350000
[2024-06-15 19:35:22,304][root][INFO] - Total data indexed 350000
[2024-06-15 19:35:22,579][root][INFO] - data indexed 400000
[2024-06-15 19:35:22,580][root][INFO] - Total data indexed 400000
[2024-06-15 19:35:23,166][root][INFO] - data indexed 450000
[2024-06-15 19:35:23,166][root][INFO] - Total data indexed 450000
[2024-06-15 19:35:23,443][root][INFO] - data indexed 500000
[2024-06-15 19:35:23,443][root][INFO] - Total data indexed 500000
[2024-06-15 19:35:23,728][root][INFO] - data indexed 550000
[2024-06-15 19:35:23,728][root][INFO] - Total data indexed 550000
[2024-06-15 19:35:23,889][root][INFO] - data indexed 600000
[2024-06-15 19:35:23,890][root][INFO] - Total data indexed 600000
[2024-06-15 19:35:24,012][root][INFO] - data indexed 606770
[2024-06-15 19:35:24,012][root][INFO] - Total data indexed 606770
[2024-06-15 19:35:24,012][root][INFO] - Data indexing completed.
[2024-06-15 19:35:25,082][root][INFO] - index search time: 1.068108 sec.
[2024-06-15 19:35:25,082][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:35:26,813][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:35:26,813][root][INFO] - validating passages. size=606770
[2024-06-15 19:35:26,813][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:35:26,813][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:35:28,045][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:35:28,068][dpr.data.qa_validation][INFO] - Per question validation results len=51
[2024-06-15 19:35:28,235][root][INFO] - Validation results: top k documents hits [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[2024-06-15 19:35:28,235][root][INFO] - Validation results: top k documents hits accuracy [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549, 0.0196078431372549]
[2024-06-15 19:35:28,273][root][INFO] - Saved results * scores  to output.json
[2024-06-15 19:35:33,046][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:35:33,047][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:35:33,047][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:35:33,047][root][INFO] - 16-bits training: False 
[2024-06-15 19:35:33,048][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:35:33,963][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:35:33,964][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:35:33,974][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_3
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:35:34,930][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:35:35,799][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:35:36,667][root][INFO] - Loading saved model state ...
[2024-06-15 19:35:36,706][root][INFO] - Selecting standard question encoder
[2024-06-15 19:35:36,942][root][INFO] - Encoder vector_size=768
[2024-06-15 19:35:36,942][root][INFO] - qa_dataset: mapqa_0609_socal_3
[2024-06-15 19:35:36,943][root][INFO] - questions len 29
[2024-06-15 19:35:36,943][root][INFO] - questions_text len 0
[2024-06-15 19:35:36,944][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:35:36,944][root][INFO] - Using special token None
[2024-06-15 19:35:38,761][root][INFO] - Total encoded queries tensor torch.Size([29, 768])
[2024-06-15 19:35:38,762][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:35:38,762][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:35:38,762][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:35:38,762][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:35:38,762][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:35:38,762][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:35:40,628][root][INFO] - data indexed 50000
[2024-06-15 19:35:40,629][root][INFO] - Total data indexed 50000
[2024-06-15 19:35:40,951][root][INFO] - data indexed 100000
[2024-06-15 19:35:40,951][root][INFO] - Total data indexed 100000
[2024-06-15 19:35:41,217][root][INFO] - data indexed 150000
[2024-06-15 19:35:41,217][root][INFO] - Total data indexed 150000
[2024-06-15 19:35:41,489][root][INFO] - data indexed 200000
[2024-06-15 19:35:41,489][root][INFO] - Total data indexed 200000
[2024-06-15 19:35:41,980][root][INFO] - data indexed 250000
[2024-06-15 19:35:41,980][root][INFO] - Total data indexed 250000
[2024-06-15 19:35:42,140][root][INFO] - data indexed 300000
[2024-06-15 19:35:42,140][root][INFO] - Total data indexed 300000
[2024-06-15 19:35:42,300][root][INFO] - data indexed 350000
[2024-06-15 19:35:42,300][root][INFO] - Total data indexed 350000
[2024-06-15 19:35:42,577][root][INFO] - data indexed 400000
[2024-06-15 19:35:42,578][root][INFO] - Total data indexed 400000
[2024-06-15 19:35:43,161][root][INFO] - data indexed 450000
[2024-06-15 19:35:43,161][root][INFO] - Total data indexed 450000
[2024-06-15 19:35:43,437][root][INFO] - data indexed 500000
[2024-06-15 19:35:43,438][root][INFO] - Total data indexed 500000
[2024-06-15 19:35:43,596][root][INFO] - data indexed 550000
[2024-06-15 19:35:43,596][root][INFO] - Total data indexed 550000
[2024-06-15 19:35:43,873][root][INFO] - data indexed 600000
[2024-06-15 19:35:43,873][root][INFO] - Total data indexed 600000
[2024-06-15 19:35:43,993][root][INFO] - data indexed 606770
[2024-06-15 19:35:43,993][root][INFO] - Total data indexed 606770
[2024-06-15 19:35:43,993][root][INFO] - Data indexing completed.
[2024-06-15 19:35:44,685][root][INFO] - index search time: 0.690830 sec.
[2024-06-15 19:35:44,686][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:35:46,671][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:35:46,671][root][INFO] - validating passages. size=606770
[2024-06-15 19:35:46,671][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:35:46,671][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:35:47,904][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:35:47,915][dpr.data.qa_validation][INFO] - Per question validation results len=29
[2024-06-15 19:35:48,080][root][INFO] - Validation results: top k documents hits [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[2024-06-15 19:35:48,080][root][INFO] - Validation results: top k documents hits accuracy [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[2024-06-15 19:35:48,103][root][INFO] - Saved results * scores  to output.json
[2024-06-15 19:35:52,835][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:35:52,835][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:35:52,835][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:35:52,836][root][INFO] - 16-bits training: False 
[2024-06-15 19:35:52,836][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:35:53,726][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:35:53,727][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:35:53,737][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_4
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:35:54,683][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:35:55,563][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:35:56,414][root][INFO] - Loading saved model state ...
[2024-06-15 19:35:56,454][root][INFO] - Selecting standard question encoder
[2024-06-15 19:35:56,683][root][INFO] - Encoder vector_size=768
[2024-06-15 19:35:56,683][root][INFO] - qa_dataset: mapqa_0609_socal_4
[2024-06-15 19:35:56,684][root][INFO] - questions len 19
[2024-06-15 19:35:56,684][root][INFO] - questions_text len 0
[2024-06-15 19:35:56,685][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:35:56,685][root][INFO] - Using special token None
[2024-06-15 19:35:58,537][root][INFO] - Total encoded queries tensor torch.Size([19, 768])
[2024-06-15 19:35:58,538][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:35:58,538][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:35:58,538][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:35:58,538][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:35:58,538][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:35:58,538][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:36:00,414][root][INFO] - data indexed 50000
[2024-06-15 19:36:00,414][root][INFO] - Total data indexed 50000
[2024-06-15 19:36:00,738][root][INFO] - data indexed 100000
[2024-06-15 19:36:00,738][root][INFO] - Total data indexed 100000
[2024-06-15 19:36:01,003][root][INFO] - data indexed 150000
[2024-06-15 19:36:01,003][root][INFO] - Total data indexed 150000
[2024-06-15 19:36:01,275][root][INFO] - data indexed 200000
[2024-06-15 19:36:01,275][root][INFO] - Total data indexed 200000
[2024-06-15 19:36:01,768][root][INFO] - data indexed 250000
[2024-06-15 19:36:01,768][root][INFO] - Total data indexed 250000
[2024-06-15 19:36:01,925][root][INFO] - data indexed 300000
[2024-06-15 19:36:01,926][root][INFO] - Total data indexed 300000
[2024-06-15 19:36:02,085][root][INFO] - data indexed 350000
[2024-06-15 19:36:02,085][root][INFO] - Total data indexed 350000
[2024-06-15 19:36:02,360][root][INFO] - data indexed 400000
[2024-06-15 19:36:02,360][root][INFO] - Total data indexed 400000
[2024-06-15 19:36:02,945][root][INFO] - data indexed 450000
[2024-06-15 19:36:02,945][root][INFO] - Total data indexed 450000
[2024-06-15 19:36:03,222][root][INFO] - data indexed 500000
[2024-06-15 19:36:03,222][root][INFO] - Total data indexed 500000
[2024-06-15 19:36:03,380][root][INFO] - data indexed 550000
[2024-06-15 19:36:03,380][root][INFO] - Total data indexed 550000
[2024-06-15 19:36:03,658][root][INFO] - data indexed 600000
[2024-06-15 19:36:03,658][root][INFO] - Total data indexed 600000
[2024-06-15 19:36:03,779][root][INFO] - data indexed 606770
[2024-06-15 19:36:03,779][root][INFO] - Total data indexed 606770
[2024-06-15 19:36:03,779][root][INFO] - Data indexing completed.
[2024-06-15 19:36:04,054][root][INFO] - index search time: 0.273389 sec.
[2024-06-15 19:36:04,055][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:36:06,040][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:36:06,040][root][INFO] - validating passages. size=606770
[2024-06-15 19:36:06,040][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:36:06,040][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:36:07,262][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:36:07,272][dpr.data.qa_validation][INFO] - Per question validation results len=19
[2024-06-15 19:36:07,440][root][INFO] - Validation results: top k documents hits [5, 5, 5, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13]
[2024-06-15 19:36:07,440][root][INFO] - Validation results: top k documents hits accuracy [0.2631578947368421, 0.2631578947368421, 0.2631578947368421, 0.3157894736842105, 0.3157894736842105, 0.3157894736842105, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.42105263157894735, 0.47368421052631576, 0.47368421052631576, 0.47368421052631576, 0.47368421052631576, 0.47368421052631576, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5263157894736842, 0.5789473684210527, 0.5789473684210527, 0.5789473684210527, 0.5789473684210527, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.631578947368421, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895, 0.6842105263157895]
[2024-06-15 19:36:07,456][root][INFO] - Saved results * scores  to output.json
[2024-06-15 19:36:12,202][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:36:12,202][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:36:12,203][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:36:12,203][root][INFO] - 16-bits training: False 
[2024-06-15 19:36:12,203][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:36:13,097][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:36:13,098][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:36:13,109][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_5
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:36:14,063][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:36:14,931][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:36:15,787][root][INFO] - Loading saved model state ...
[2024-06-15 19:36:15,831][root][INFO] - Selecting standard question encoder
[2024-06-15 19:36:16,070][root][INFO] - Encoder vector_size=768
[2024-06-15 19:36:16,070][root][INFO] - qa_dataset: mapqa_0609_socal_5
[2024-06-15 19:36:16,072][root][INFO] - questions len 51
[2024-06-15 19:36:16,072][root][INFO] - questions_text len 0
[2024-06-15 19:36:16,072][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:36:16,072][root][INFO] - Using special token None
[2024-06-15 19:36:18,097][root][INFO] - Total encoded queries tensor torch.Size([51, 768])
[2024-06-15 19:36:18,098][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:36:18,098][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:36:18,098][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:36:18,098][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:36:18,098][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:36:18,098][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:36:19,977][root][INFO] - data indexed 50000
[2024-06-15 19:36:19,977][root][INFO] - Total data indexed 50000
[2024-06-15 19:36:20,301][root][INFO] - data indexed 100000
[2024-06-15 19:36:20,301][root][INFO] - Total data indexed 100000
[2024-06-15 19:36:20,569][root][INFO] - data indexed 150000
[2024-06-15 19:36:20,569][root][INFO] - Total data indexed 150000
[2024-06-15 19:36:20,841][root][INFO] - data indexed 200000
[2024-06-15 19:36:20,841][root][INFO] - Total data indexed 200000
[2024-06-15 19:36:21,215][root][INFO] - data indexed 250000
[2024-06-15 19:36:21,215][root][INFO] - Total data indexed 250000
[2024-06-15 19:36:21,490][root][INFO] - data indexed 300000
[2024-06-15 19:36:21,490][root][INFO] - Total data indexed 300000
[2024-06-15 19:36:21,651][root][INFO] - data indexed 350000
[2024-06-15 19:36:21,651][root][INFO] - Total data indexed 350000
[2024-06-15 19:36:21,927][root][INFO] - data indexed 400000
[2024-06-15 19:36:21,927][root][INFO] - Total data indexed 400000
[2024-06-15 19:36:22,515][root][INFO] - data indexed 450000
[2024-06-15 19:36:22,515][root][INFO] - Total data indexed 450000
[2024-06-15 19:36:22,790][root][INFO] - data indexed 500000
[2024-06-15 19:36:22,790][root][INFO] - Total data indexed 500000
[2024-06-15 19:36:23,074][root][INFO] - data indexed 550000
[2024-06-15 19:36:23,075][root][INFO] - Total data indexed 550000
[2024-06-15 19:36:23,234][root][INFO] - data indexed 600000
[2024-06-15 19:36:23,234][root][INFO] - Total data indexed 600000
[2024-06-15 19:36:23,354][root][INFO] - data indexed 606770
[2024-06-15 19:36:23,354][root][INFO] - Total data indexed 606770
[2024-06-15 19:36:23,354][root][INFO] - Data indexing completed.
[2024-06-15 19:36:24,307][root][INFO] - index search time: 0.951111 sec.
[2024-06-15 19:36:24,307][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:36:26,039][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:36:26,039][root][INFO] - validating passages. size=606770
[2024-06-15 19:36:26,039][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:36:26,039][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:36:27,263][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:36:27,295][dpr.data.qa_validation][INFO] - Per question validation results len=51
[2024-06-15 19:36:27,482][root][INFO] - Validation results: top k documents hits [4, 7, 9, 9, 11, 12, 12, 12, 12, 12, 13, 13, 15, 15, 15, 15, 15, 15, 15, 15, 16, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 20, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24]
[2024-06-15 19:36:27,483][root][INFO] - Validation results: top k documents hits accuracy [0.0784313725490196, 0.13725490196078433, 0.17647058823529413, 0.17647058823529413, 0.21568627450980393, 0.23529411764705882, 0.23529411764705882, 0.23529411764705882, 0.23529411764705882, 0.23529411764705882, 0.2549019607843137, 0.2549019607843137, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.29411764705882354, 0.3137254901960784, 0.3333333333333333, 0.3333333333333333, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.35294117647058826, 0.37254901960784315, 0.37254901960784315, 0.37254901960784315, 0.37254901960784315, 0.39215686274509803, 0.39215686274509803, 0.39215686274509803, 0.39215686274509803, 0.39215686274509803, 0.43137254901960786, 0.43137254901960786, 0.43137254901960786, 0.43137254901960786, 0.43137254901960786, 0.43137254901960786, 0.43137254901960786, 0.43137254901960786, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.45098039215686275, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764, 0.47058823529411764]
[2024-06-15 19:36:27,524][root][INFO] - Saved results * scores  to output.json
[2024-06-15 19:36:32,228][root][INFO] - CFG's local_rank=-1
[2024-06-15 19:36:32,229][root][INFO] - Env WORLD_SIZE=None
[2024-06-15 19:36:32,229][root][INFO] - Initialized host ip-172-31-69-60.ec2.internal as d.rank -1 on device=cuda, n_gpu=4, world size=1
[2024-06-15 19:36:32,229][root][INFO] - 16-bits training: False 
[2024-06-15 19:36:32,229][root][INFO] - Reading saved model from /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
[2024-06-15 19:36:33,130][root][INFO] - model_state_dict keys dict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-06-15 19:36:33,131][root][INFO] - CFG (after gpu  configuration):
[2024-06-15 19:36:33,141][root][INFO] - encoder:
  encoder_model_type: hf_geolm
  pretrained_model_cfg: zekun-li/geolm-base-cased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 256
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
datasets:
  mapqa_0609_socal_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_adjacent.csv
  mapqa_0609_socal_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around_specific.csv
  mapqa_0609_socal_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities_around.csv
  mapqa_0609_socal_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_amenities.csv
  mapqa_0609_socal_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_compare_closer.csv
  mapqa_0609_socal_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_direction_nearest.csv
  mapqa_0609_socal_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/socal_0607/test/test_socal_dpr_cased_nearest_amenity.csv
  mapqa_0609_il_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_adjacent.csv
  mapqa_0609_il_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around_specific.csv
  mapqa_0609_il_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities_around.csv
  mapqa_0609_il_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_amenities.csv
  mapqa_0609_il_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_compare_closer.csv
  mapqa_0609_il_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_direction_nearest.csv
  mapqa_0609_il_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/il_0607/test/test_il_dpr_cased_nearest_amenity.csv
  mapqa_illinois_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/illinois/test_dpr_cased.csv
  mapqa_test_all:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased.csv
  mapqa_test_0:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_0.csv
  mapqa_test_1:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_1.csv
  mapqa_test_2:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_2.csv
  mapqa_test_3:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_3.csv
  mapqa_test_4:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_4.csv
  mapqa_test_5:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_5.csv
  mapqa_test_6:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_6.csv
  mapqa_test_7:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/data/1215/test_dpr_cased_7.csv
  mapqa_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: /home/zekun/mapqa/DPR/downloads/data/retriever/qas/mapqa-test-1121.csv
  nq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-test
  nq_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-train
  nq_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.nq-dev
  trivia_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-test
  trivia_train:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-train
  trivia_dev:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.trivia-dev
  webq_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.webq-test
  curatedtrec_test:
    _target_: dpr.data.retriever_data.CsvQASrc
    file: data.retriever.qas.curatedtrec-test
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  mapqa_socal_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/socal_0607/entities.tsv
  mapqa_il_entity_ctx:
    _target_: dpr.data.retriever_data.MapQACsvCtxSrc
    file: /home/zekun/mapqa/data/il_0607/entities.tsv
indexers:
  flat:
    _target_: dpr.indexer.faiss_indexers.DenseFlatIndexer
  hnsw:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWFlatIndexer
  hnsw_sq:
    _target_: dpr.indexer.faiss_indexers.DenseHNSWSQIndexer
qa_dataset: mapqa_0609_socal_6
ctx_datatsets:
- mapqa_socal_entity_ctx
encoded_ctx_files:
- /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
out_file: output.json
match: string
n_docs: 100
validation_workers: 16
batch_size: 32
do_lower_case: true
encoder_path: null
index_path: null
kilt_out_file: null
model_file: /home/zekun/mapqa/DPR/outputs/2024-06-15/08-36-08/weights/dpr_biencoder.26
validate_as_tables: false
rpc_retriever_cfg_file: null
rpc_index_id: null
use_l2_conversion: false
use_rpc_meta: false
rpc_meta_compressed: false
indexer: flat
special_tokens: null
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 4
fp16: false
fp16_opt_level: O1

[2024-06-15 19:36:34,091][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:36:34,982][dpr.models.hf_models][INFO] - Initializing HF GeoLM Encoder. cfg_name=zekun-li/geolm-base-cased
[2024-06-15 19:36:35,846][root][INFO] - Loading saved model state ...
[2024-06-15 19:36:35,883][root][INFO] - Selecting standard question encoder
[2024-06-15 19:36:36,160][root][INFO] - Encoder vector_size=768
[2024-06-15 19:36:36,161][root][INFO] - qa_dataset: mapqa_0609_socal_6
[2024-06-15 19:36:36,162][root][INFO] - questions len 45
[2024-06-15 19:36:36,162][root][INFO] - questions_text len 0
[2024-06-15 19:36:36,162][root][INFO] - Local Index class <class 'dpr.indexer.faiss_indexers.DenseFlatIndexer'> 
[2024-06-15 19:36:36,162][root][INFO] - Using special token None
[2024-06-15 19:36:38,154][root][INFO] - Total encoded queries tensor torch.Size([45, 768])
[2024-06-15 19:36:38,155][root][INFO] - ctx_sources: <class 'dpr.data.retriever_data.MapQACsvCtxSrc'>
[2024-06-15 19:36:38,155][root][INFO] - id_prefixes per dataset: [None]
[2024-06-15 19:36:38,155][root][INFO] - ctx_files_patterns: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:36:38,156][root][INFO] - Embeddings files id prefixes: [None]
[2024-06-15 19:36:38,156][root][INFO] - Reading all passages data from files: ['/home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0']
[2024-06-15 19:36:38,156][root][INFO] - Reading file /home/zekun/mapqa/DPR/downloads/data/mapqa_retriever_results/geolm-2024-06-15-08-36-08-socal.pkl_0
[2024-06-15 19:36:40,079][root][INFO] - data indexed 50000
[2024-06-15 19:36:40,079][root][INFO] - Total data indexed 50000
[2024-06-15 19:36:40,411][root][INFO] - data indexed 100000
[2024-06-15 19:36:40,411][root][INFO] - Total data indexed 100000
[2024-06-15 19:36:40,695][root][INFO] - data indexed 150000
[2024-06-15 19:36:40,695][root][INFO] - Total data indexed 150000
[2024-06-15 19:36:40,978][root][INFO] - data indexed 200000
[2024-06-15 19:36:40,978][root][INFO] - Total data indexed 200000
[2024-06-15 19:36:41,375][root][INFO] - data indexed 250000
[2024-06-15 19:36:41,376][root][INFO] - Total data indexed 250000
[2024-06-15 19:36:41,658][root][INFO] - data indexed 300000
[2024-06-15 19:36:41,659][root][INFO] - Total data indexed 300000
[2024-06-15 19:36:41,828][root][INFO] - data indexed 350000
[2024-06-15 19:36:41,828][root][INFO] - Total data indexed 350000
[2024-06-15 19:36:42,115][root][INFO] - data indexed 400000
[2024-06-15 19:36:42,116][root][INFO] - Total data indexed 400000
[2024-06-15 19:36:42,737][root][INFO] - data indexed 450000
[2024-06-15 19:36:42,737][root][INFO] - Total data indexed 450000
[2024-06-15 19:36:43,025][root][INFO] - data indexed 500000
[2024-06-15 19:36:43,025][root][INFO] - Total data indexed 500000
[2024-06-15 19:36:43,321][root][INFO] - data indexed 550000
[2024-06-15 19:36:43,321][root][INFO] - Total data indexed 550000
[2024-06-15 19:36:43,486][root][INFO] - data indexed 600000
[2024-06-15 19:36:43,487][root][INFO] - Total data indexed 600000
[2024-06-15 19:36:43,609][root][INFO] - data indexed 606770
[2024-06-15 19:36:43,609][root][INFO] - Total data indexed 606770
[2024-06-15 19:36:43,609][root][INFO] - Data indexing completed.
[2024-06-15 19:36:44,605][root][INFO] - index search time: 0.993858 sec.
[2024-06-15 19:36:44,605][dpr.data.retriever_data][INFO] - Reading file /home/zekun/mapqa/data/socal_0607/entities.tsv
[2024-06-15 19:36:46,352][root][INFO] - Loaded ctx data: 606770
[2024-06-15 19:36:46,352][root][INFO] - validating passages. size=606770
[2024-06-15 19:36:46,352][dpr.data.qa_validation][INFO] - all_docs size 606770
[2024-06-15 19:36:46,352][dpr.data.qa_validation][INFO] - dpr_all_documents size 606770
[2024-06-15 19:36:47,582][dpr.data.qa_validation][INFO] - Matching answers in top docs...
[2024-06-15 19:36:47,602][dpr.data.qa_validation][INFO] - Per question validation results len=45
[2024-06-15 19:36:47,770][root][INFO] - Validation results: top k documents hits [8, 10, 11, 12, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25]
[2024-06-15 19:36:47,770][root][INFO] - Validation results: top k documents hits accuracy [0.17777777777777778, 0.2222222222222222, 0.24444444444444444, 0.26666666666666666, 0.3111111111111111, 0.3111111111111111, 0.3111111111111111, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.37777777777777777, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4222222222222222, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4444444444444444, 0.4666666666666667, 0.4666666666666667, 0.4666666666666667, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.4888888888888889, 0.5111111111111111, 0.5111111111111111, 0.5111111111111111, 0.5111111111111111, 0.5111111111111111, 0.5111111111111111, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5333333333333333, 0.5555555555555556, 0.5555555555555556, 0.5555555555555556]
[2024-06-15 19:36:47,808][root][INFO] - Saved results * scores  to output.json
